@using CarProject.App_Code

@model CarProject.Areas.Admin.Models.Cars.TroubleshootingClass

@{
    ViewBag.Title = "ثبت سوال عیب یابی";
}



<form method="post">
    @Html.HiddenFor(m => m.Troubleshooting.FatherId)
    <div class="inputsContainer">
        @Html.input_TextBox(m => m.Troubleshooting.Question, "سوال")
        @Html.input_TextArea(m => m.Troubleshooting.Answer, "جواب")

        @Html.input_SearchBox(m => m.Troubleshooting.ProductId, "قطعه معیوب" , "messagebox()")

        @Html.input_TextBox(m => m.Troubleshooting.ServicePrice, "قیمت سرویس و تعمیر")
    </div>
    <div id="formActionSection">
        <a href="@Url.Action("Index","Troubleshooting")" class="button red">برگشت</a>
        <input type="submit" class="button green" name="saveOnly" value="ثبت اطلاعات و اتمام" />
        <input type="submit" class="button green" name="saveAndContinueThisAsRoot" value="ثبت اطلاعات و اضافه کردن سوال به سوال جاری" />
        <input type="submit" class="button green" name="saveAndContinueToThisRoot" value="ثبت اطلاعات و اضافه کردن سوال به ریشه جاری" />

    </div>
</form>


@if (Model.Troubleshooting.FatherId != null && Model.Troubleshooting.FatherId > 0)
{
    var dbs = new CarProject.DBSEF.CarAutomationEntities();
    var xint = dbs.Troubleshootings.FirstOrDefault( m => m.TroubleshootingId == Model.Troubleshooting.FatherId);
    
    <div id="ShowFathers">
        @while (xint != null)
        {
            <div class="FatherItem">
                <strong>@xint.Question</strong>
                <section>@xint.Answer</section>
            </div>
            
            xint = dbs.Troubleshootings.FirstOrDefault(m => m.TroubleshootingId == xint.FatherId);
        }
    </div>
}



@section script
{
    <script>
        @*tinymce.init({
            selector: '#@Html.IdFor(m => m.Troubleshooting.Answer)',
            content_css: '@System.Web.VirtualPathUtility.ToAbsolute("~/Publics/Styles/fonts/Fonts.css"),@System.Web.VirtualPathUtility.ToAbsolute("~/Areas/Admin/Files/StyleAndScripts/Default/tinymce01.css")',
            directionality: 'rtl',
            menubar: false,
            plugins: "directionality,link",
            toolbar: "rtl ltr | bold italic underline | bullist numlist | undo redo | link unlink"
        });*@

        function messagebox() {
            vx = document.getElementById("@Html.input_SearchBox_ID(m => m.Troubleshooting.ProductId)");
            vx.innerHTML = "این قسمت هنوز تکمیل نشده است";
        }
    </script>
}

@section style
{
    <style>
        #formActionSection {
            border-top:thin solid #888;
            text-align:left;
        }

        #ShowFathers {

            margin-top:10px;
            padding-top:10px;
            border-top:thin solid #888;
        }

        .FatherItem {
            border:thin solid #BBB;
            margin:2px;
            padding:3px;
        }
    </style>
}